## 书籍信息

- 书名: 分布式系统应用设计
- 作者: Brendan，Burns 著，赵军平，王天青 译
- 出版社: 中国电力出版社
- 来源: 纸书
- 源代码: [github](https://github.com/brendandburns/designing-distributed-systems)

## 简介

作者介绍了分布式系统开发中的常见模式.

## 单节点模式

在单个节点上调用一组容器的常见模式.

### 边车模式

边车模式通常由两个容器组成, 第一个容器是主容器, 包含应用程序的核心逻辑, 第二个容器是边车容器.
边车容器为主容器附加额外的功能, 而无需改动主容器. 边车容器和主容器共享大部分资源,
包括文件系统, 网络, 主机名等.

### 大使模式

大使容器代理应用容器与外部之间的交互.

### 适配器模式

适配器容器修改应用容器的接口, 使其符合第三方应用所需的某些预定义接口规范.

## 服务模式

多节点分布式架构上常见的模式.

### 基于副本的负载均衡模式

使用水平扩展的多实例提供服务.

### 分片服务

对于数据量巨大的应用, 使用分片服务来扩展节点, 以满足数据大小要求.

### 分散模式与聚集模式

分散/聚集模式在服务请求中实现了并行性, 通过对请求所需的计算进行分片, 提高系统性能.

### 函数与事件驱动处理

基于事件驱动的函数式处理, FaaS, 功能即服务(Function as a Service).

### 所有权选举

使用分布式锁实现的分布式一致性算法, Paxos 和 RAFT 算法. 很多分布式键值存储已经实现了这些算法.

原子比较-交换(compare-and-swap): 如果数值与预期值匹配, 以原子方式写入新值. 如果不匹配, 返回 false.
如果该值不存在且 currentValue 不为 null, 则返回错误.

## 批处理计算模式

批处理仅在短时间内运行, 而不是长期运行. 通常需要并行处理大量数据以加快速度. 最著名的模式是 MapReduce.

### 工作队列系统

工作队列包含了一组要被执行的批处理任务. 任务之间相互独立, 无需交互.

### 事件驱动的批处理

工作流系统是一个用有向无环图表示的工作流程, 工作队列之间需要链接,
上一个工作队列的输出可能是下一个或多个工作队列的输入.

- 复制器模式: 单个工作流复制到多个流中进行不同的处理
- 过滤器模式: 过滤掉不符合要求的工作项, 来减少待处理的工作项数量
- 分离器模式: 分离器根据标准, 将不同的输入发送到指定的队列
- 分片器模式: 将单个队列划分为均匀分别的工作项集合, 降低故障风险等
- 合并器模式: 将两个不同的工作队列合并为单个工作队列

构建工作流的方式通常使用发布者/订阅者系统(pub/sub).

### 协调批处理

- 连接模式: 等待并行处理的所有工作都完成, 才继续进行下一步操作. 类似于并发编程的栅栏模同步.
- Reduce: 以乐观的模式将所有并行数据项合并到一个完整集合中. 可以重复执行, 直到只剩下一个输出.
